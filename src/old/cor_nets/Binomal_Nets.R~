###Binomal Analysis of Species Co-occurrence Data

library(limma) #From the bioconductor repository source("http://www.bioconductor.org/biocLite.R")
library(gdata)

#library(venn) #installed from http://fisher.stats.uwo.ca/faculty/murdoch/repos/html/vennv1.5.htmlm
#This function did not work.

#Binomial distribution
my.pbinom <- function(k,n,p){choose(n,k)*p^k*(1-p)^(n-k)}
plot.binom <- function(n,p,by=1,pch=19,lty=1,xlim=c(0,n),p.col=1,l.col=1,ylim=c(0,0.2),empty=TRUE){p
if (empty == TRUE){p.type <- 'n'}else{p.type <- 'p'}
plot(my.pbinom(seq(0,n,by=by),n,p)~seq(0,n,by=by),type=p.type,pch=pch,col=p.col,ylim=ylim,xlab='',ylab='')
if (empty == TRUE){}else{lines(my.pbinom(seq(0,n,by=by),n,p)~seq(0,n,by=by),lty=lty,col=l.col)}
}

##General example from Wikipedia binomial distribution page
plot.binom(20,0.5,p.col=3,ylim=c(0,0.35))
n=20;p=0.5;by=1
lines(my.pbinom(seq(0,n,by=by),n,p)~seq(0,n,by=by),lty=1,col=3)
p=0.1
lines(my.pbinom(seq(0,n,by=by),n,p)~seq(0,n,by=by),lty=1,col=4)
p=0.8
lines(my.pbinom(seq(0,n,by=by),n,p)~seq(0,n,by=by),lty=1,col=2)
title(xlab='k = Number of Sucesses',ylab='Probability')

##Start
n <- 100 #number of observations
A <- rbinom(n,1,0.5) #sample for species A
B <- rbinom(n,1,0.5) #sample for species B
AB <- A+B

plot.bdist(A,B)
binom.test(length(AB[AB==2]),length(A[A==1]))
